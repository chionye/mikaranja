"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[447],{2252:(e,t,a)=>{a.d(t,{Y:()=>f,p:()=>N});var r=a(5155),o=a(6874),s=a.n(o),n=a(2115),l=a(4011),i=a(3999);function c(e){let{className:t,...a}=e;return(0,r.jsx)(l.bL,{"data-slot":"avatar",className:(0,i.cn)("relative flex size-8 shrink-0 overflow-hidden rounded-full",t),...a})}function d(e){let{className:t,...a}=e;return(0,r.jsx)(l._V,{"data-slot":"avatar-image",className:(0,i.cn)("aspect-square size-full",t),...a})}function u(e){let{className:t,...a}=e;return(0,r.jsx)(l.H4,{"data-slot":"avatar-fallback",className:(0,i.cn)("bg-muted flex size-full items-center justify-center rounded-full",t),...a})}var v=a(7168),g=a(3274);let f=()=>{let{logout:e,user:t}=(0,g.A)(),a=(0,n.useMemo)(()=>(null==t?void 0:t.firstName)&&(null==t?void 0:t.lastName)?"".concat(t.firstName.charAt(0)).concat(t.lastName.charAt(0)).toUpperCase():(null==t?void 0:t.username)?t.username.charAt(0).toUpperCase():"UN",[t]),o=(0,n.useMemo)(()=>"UN"!==a?"https://api.dicebear.com/8.x/api/svg?seed=".concat(a):"https://github.com/shadcn.png",[a]);return(0,r.jsx)("header",{className:"bg-stone-50 fixed top-0 left-0 right-0 p-3 border-b border-black h-16 z-10",children:(0,r.jsxs)("div",{className:"flex justify-between items-center h-full",children:[(0,r.jsx)("div",{children:(0,r.jsx)(s(),{href:"/tasks",className:"text-xl font-bold text-gray-800 hover:text-gray-900 transition-colors",children:"Toodoles"})}),(0,r.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,r.jsxs)(c,{children:[(0,r.jsx)(d,{src:o,alt:"".concat((null==t?void 0:t.firstName)||(null==t?void 0:t.username),"'s avatar")}),(0,r.jsx)(u,{children:a})]}),(0,r.jsx)(v.$,{variant:"ghost",onClick:e,className:"text-red-600 hover:bg-red-50 hover:text-red-700 cursor-pointer",children:"Log out"})]})]})})};var h=a(2715);function m(e){let{className:t,children:a,viewport:o=!0,...s}=e;return(0,r.jsxs)(h.bL,{"data-slot":"navigation-menu","data-viewport":o,className:(0,i.cn)("group/navigation-menu relative w-full",t),...s,children:[a,o&&(0,r.jsx)(b,{})]})}function x(e){let{className:t,...a}=e;return(0,r.jsx)(h.B8,{"data-slot":"navigation-menu-list",className:(0,i.cn)("group w-full ",t),...a})}function p(e){let{className:t,...a}=e;return(0,r.jsx)(h.q7,{"data-slot":"navigation-menu-item",className:(0,i.cn)("relative",t),...a})}function b(e){let{className:t,...a}=e;return(0,r.jsx)("div",{className:(0,i.cn)("absolute top-full left-0 isolate z-50 flex justify-center"),children:(0,r.jsx)(h.LM,{"data-slot":"navigation-menu-viewport",className:(0,i.cn)("origin-top-center bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border shadow md:w-[var(--radix-navigation-menu-viewport-width)]",t),...a})})}function k(e){let{className:t,...a}=e;return(0,r.jsx)(h.N_,{"data-slot":"navigation-menu-link",className:(0,i.cn)("data-[active=true]:focus:bg-accent data-[active=true]:hover:bg-accent data-[active=true]:bg-accent/50 data-[active=true]:text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus-visible:ring-ring/50 [&_svg:not([class*='text-'])]:text-muted-foreground flex flex-col gap-1 rounded-sm p-2 text-sm transition-all outline-none focus-visible:ring-[3px] focus-visible:outline-1 [&_svg:not([class*='size-'])]:size-4",t),...a})}(0,a(2085).F)("group inline-flex h-9 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground disabled:pointer-events-none disabled:opacity-50 data-[state=open]:hover:bg-accent data-[state=open]:text-accent-foreground data-[state=open]:focus:bg-accent data-[state=open]:bg-accent/50 focus-visible:ring-ring/50 outline-none transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1");let y=e=>{let{url:t="#",label:a,icon:o,endIcon:n}=e;return(0,r.jsxs)(s(),{href:t,className:"flex flex-row w-full items-center gap-2",children:[o,(0,r.jsx)("span",{className:"capitalize text-[16px]",children:a}),n]})};var j=a(3783);let w=[{id:(0,a(1368).A)(),label:"My Tasks",icon:(0,r.jsx)(j.A,{size:18}),url:"/tasks",items:[]}],T=e=>{let{parent:t}=e;return(0,r.jsxs)("div",{children:[(0,r.jsx)(p,{children:(0,r.jsx)(k,{asChild:!0,children:(0,r.jsx)(y,{...t})})}),(0,r.jsx)("div",{className:"border-l ml-3",children:t.items.map(e=>(0,r.jsx)(p,{children:(0,r.jsx)(k,{asChild:!0,children:(0,r.jsx)(y,{...e})})},e.id))})]})},N=()=>(0,r.jsx)("aside",{className:"bg-stone-50 w-56 h-screen fixed top-16 bottom-0 left-0 py-3 border-r border-black px-4 hidden md:block",children:(0,r.jsx)("nav",{className:"w-full",children:(0,r.jsx)(m,{children:(0,r.jsx)(x,{className:"flex flex-col w-full items-start",children:w.map(e=>{var t;return(null==(t=e.items)?void 0:t.length)===0?(0,r.jsx)(p,{children:(0,r.jsx)(k,{asChild:!0,children:(0,r.jsx)(y,{...e})})},e.id):(0,r.jsx)(T,{parent:e},e.id)})})})})})},2870:(e,t,a)=>{a.d(t,{l:()=>n});var r=a(2987);let o=(0,r.iq)(),s=(0,r.MB)(),n={getTodo:o,postTodo:s,patchTodo:(0,r.AW)(),deleteTodo:(0,r.Fb)()}},2987:(e,t,a)=>{a.d(t,{AW:()=>v,Fb:()=>g,MB:()=>u,O5:()=>i,iq:()=>d});var r=a(3464),o=a(4747);let s=o.A.BASE_URL_DEV,n=r.A.create({baseURL:s,headers:{"Content-Type":"application/json"},timeout:1e4}),l=null,i=e=>{l=e};function c(e,t){let a={};return"string"==typeof t?a.Authorization="Bearer ".concat(t):"object"==typeof t&&Object.assign(a,t),e instanceof FormData&&a["Content-Type"]&&delete a["Content-Type"],a}function d(){return async(e,t)=>{try{let a={headers:c(void 0,null==t?void 0:t.tokenOrHeaders)};return await n.get(e,a)}catch(e){var a;throw console.error("GET Request Error:",e),(null==(a=e.response)?void 0:a.data)||e}}}function u(){return async(e,t)=>{try{let a={headers:c(null==t?void 0:t.data,null==t?void 0:t.tokenOrHeaders)};return await n.post(e,null==t?void 0:t.data,a)}catch(e){var a;throw console.error("POST Request Error:",e),(null==(a=e.response)?void 0:a.data)||e}}}function v(){return async(e,t)=>{try{let a={headers:c(null==t?void 0:t.data,null==t?void 0:t.tokenOrHeaders)};return await n.patch(e,null==t?void 0:t.data,a)}catch(e){var a;throw console.error("PATCH Request Error:",e),(null==(a=e.response)?void 0:a.data)||e}}}function g(){return async(e,t)=>{try{let a={headers:c(void 0,null==t?void 0:t.tokenOrHeaders)};return await n.delete(e,{...a})}catch(e){var a;throw console.error("DELETE Request Error:",e),(null==(a=e.response)?void 0:a.data)||e}}}n.interceptors.request.use(async e=>{var t;if(!l){let e=localStorage.getItem("userToken");e&&(l=e)}return!l||(null==(t=e.url)?void 0:t.endsWith(o.A.Login))||(e.headers.Authorization="Bearer ".concat(l)),e},e=>Promise.reject(e)),n.interceptors.response.use(e=>e,async e=>{var t,a;return((null==(t=e.response)?void 0:t.status)===401||(null==(a=e.response)?void 0:a.status)===403)&&(console.warn("Unauthorized access. Clearing token and redirecting to login."),localStorage.removeItem("userToken"),localStorage.removeItem("userInfo"),i(null),i(null)),Promise.reject(e)})},3274:(e,t,a)=>{a.d(t,{A:()=>u,AuthProvider:()=>d});var r=a(5155),o=a(2115),s=a(5695),n=a(4747),l=a(2987),i=a(2870);let c=(0,o.createContext)(void 0),d=e=>{let{children:t}=e,[a,d]=(0,o.useState)(null),[u,v]=(0,o.useState)(!0),g=(0,s.useRouter)();(0,o.useEffect)(()=>{(()=>{try{let e=localStorage.getItem("userInfo"),t=localStorage.getItem("userToken");if(e&&t){let a=JSON.parse(e);d(a),(0,l.O5)(t)}}catch(e){console.error("Failed to load auth state from storage:",e)}finally{v(!1)}})()},[]);let f=async(e,t)=>{v(!0);try{let a=await i.l.postTodo(n.A.Login,{data:{username:e,password:t}}),r=a.data;if(console.log(r),200!==a.status||!r.accessToken)return{success:!1,error:"Unexpected API response."};{let e=r.accessToken;return localStorage.setItem("userInfo",JSON.stringify(r)),localStorage.setItem("userToken",e),d(r),(0,l.O5)(e),{success:!0,error:null}}}catch(t){var a,r;let e=(null==t||null==(r=t.response)||null==(a=r.data)?void 0:a.message)||(null==t?void 0:t.message)||"Invalid credentials. Please try again.";return console.error("Login error:",t),{success:!1,error:e}}finally{v(!1)}},h=async()=>{v(!0);try{localStorage.removeItem("userInfo"),localStorage.removeItem("userToken"),d(null),(0,l.O5)(null),g.push("/")}catch(e){console.error("Logout error:",e)}finally{v(!1)}};return(0,r.jsx)(c.Provider,{value:{user:a,isLoading:u,login:f,logout:h},children:t})},u=()=>{let e=(0,o.useContext)(c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},3999:(e,t,a)=>{a.d(t,{cn:()=>s});var r=a(2596),o=a(9688);function s(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,o.QP)((0,r.$)(t))}},4747:(e,t,a)=>{a.d(t,{A:()=>r});class r{}r.BASE_URL_DEV="https://dummyjson.com",r.Login="/auth/login",r.FetchTodo=(e,t)=>"/todos?limit=".concat(e,"&skip=").concat(t),r.FetchTodoByUserID=e=>"/todos/user/".concat(e),r.CreateTodo="/todos/add",r.UpdateTodo=e=>"/todos/".concat(e)},7001:(e,t,a)=>{a.d(t,{U:()=>c,n:()=>i});var r=a(5155),o=a(2115),s=a(2870),n=a(4747);let l=(0,o.createContext)(void 0),i=e=>{let{children:t}=e,[a,i]=(0,o.useState)([]);(0,o.useEffect)(()=>{try{let e=localStorage.getItem("tasks");if(e){let t=JSON.parse(e);i(t),console.log("TaskContext: Loaded tasks from localStorage.")}}catch(e){console.error("TaskContext: Failed to parse tasks from localStorage",e),localStorage.removeItem("tasks")}},[]);let c=(0,o.useCallback)(e=>{i(t=>{let a;return t.find(t=>t.id===e.id)?(a=t.map(t=>t.id===e.id?e:t),console.log("TaskContext: Task updated, localStorage updated.")):a=[e,...t],localStorage.setItem("tasks",JSON.stringify(a)),a})},[]),d=(0,o.useCallback)(e=>{i(t=>{let a=new Map;t.forEach(e=>a.set(e.id,e)),e.forEach(e=>a.set(e.id,e));let r=Array.from(a.values()).sort((e,t)=>e.id-t.id);return localStorage.setItem("tasks",JSON.stringify(r)),console.log("TaskContext: Synced with API data, localStorage updated."),r})},[]),u=(0,o.useCallback)(async e=>{if(console.log("TaskContext: Optimistically deleting task ID: ".concat(e," from local state and localStorage.")),i(t=>{let a=t.filter(t=>t.id!==e);return localStorage.setItem("tasks",JSON.stringify(a)),a}),!(e<=200))return void console.log("TaskContext: Task ID: ".concat(e," is a local-only task. Skipping API delete."));try{console.log("TaskContext: Attempting to delete task ID: ".concat(e," from API."));let t=await s.l.deleteTodo(n.A.UpdateTodo(e));200===t.status?console.log("TaskContext: Task ID: ".concat(e," successfully deleted from API.")):console.error("TaskContext: API delete failed for task ID: ".concat(e,". Status: ").concat(t.status),t.data)}catch(t){console.error("TaskContext: Error during API delete request for task ID: ".concat(e,"."),t)}},[]);return(0,r.jsx)(l.Provider,{value:{todos:a,setTodos:i,addOrUpdateTask:c,syncTodos:d,deleteTask:u},children:t})},c=()=>{let e=(0,o.useContext)(l);if(!e)throw Error("useTaskContext must be used within a TaskProvider");return e}},7168:(e,t,a)=>{a.d(t,{$:()=>i});var r=a(5155);a(2115);var o=a(9708),s=a(2085),n=a(3999);let l=(0,s.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function i(e){let{className:t,variant:a,size:s,asChild:i=!1,...c}=e,d=i?o.DX:"button";return(0,r.jsx)(d,{"data-slot":"button",className:(0,n.cn)(l({variant:a,size:s,className:t})),...c})}}}]);